<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="https://raw.githubusercontent.com/phipalibunao/CS3_2ndQtr_K18_K21/main/assets/cspairproj_favicon2.png" sizes="any">
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/phipalibunao/CS3_2ndQtr_K18_K21/main/assets/cspairproj_favicon2.png">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Fractured Night â€” Public Duty</title>
    <meta name="description" content="Webpage telling the story of the fourth act.">
    <meta name="author" content="Phipa Libunao, Datu Macalintal">

    <link href="https://fonts.googleapis.com/css2?family=Special+Elite&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/styles/story4.css">

</head>
<body>

<!-- PLAYER TAG -->
<div id="playerTag"></div>

<div class="navbar">
    <a href="homepage.html">Home</a>
    <a href="story1.html">Act 1</a>
    <a href="story2.html">Act 2</a>
    <a href="story3.html">Act 3</a>
    <a href="story4.html">Act 4</a>
    <a href="aboutus.html">About Us</a>
</div>

<div class="wrap">
    <header>
        <h1>Chapter 4: Public Duty</h1>
        <div class="pov-sign">POV: Mayor</div>
        <p class="lead">
            The bridge collapse shook the city. Publicly, you appear responsible, managing budgets and overseeing maintenance.
            Behind the scenes, you must protect the city's trust while holding others accountable.
        </p>
    </header>

    <div class="card-scene">
        <div class="story-text" id="storyText">
            You personally performed maintenance checks on the bridge and managed the budget responsibly.
            Publicly, You blame the engineer and supervisor to maintain trust in the city.
        </div>

        <div class="outcome" id="outcome">
            Select the correct budget allocations to show responsible management:
        </div>

        <div id="budget-game" style="margin-top: 12px;">
            <p>Bridge Repair Budget: Which option did I allocate to materials?</p>
            <button class="choice-btn" onclick="checkChoice(1)">A) 1000</button>
            <button class="choice-btn" onclick="checkChoice(2)">B) 2000</button>
            <button class="choice-btn" onclick="checkChoice(3)">C) 3000</button>
            <button class="choice-btn" onclick="checkChoice(4)">D) 4000</button>
        </div>
        <button id="nextChapterBtn" onclick="proceedChapter()">Proceed to the Final Game</button>
    </div>
</div>

<script>
// Set Player Tag
const playerTag = document.getElementById("playerTag");
const playerName = localStorage.getItem("playerName") || "Guest";
playerTag.textContent = `Player: ${playerName}`;

// Budget Game Logic
const answers = [2, 3, 1];
let currentQ = 0;

const nextBtn = document.getElementById("nextChapterBtn"); 

function checkChoice(choice) {
    const outcome = document.getElementById('outcome');
    if (choice === answers[currentQ]) {
        outcome.innerHTML = "Correct!";
        currentQ++;
        nextQuestion();
    } else {
        outcome.innerHTML = "Try again!";
    }
}

function nextQuestion() {
    const gameDiv = document.getElementById('budget-game');

    if (currentQ === 1) {
        gameDiv.innerHTML = `
            <p>Staff Salaries: Which option went to overtime payments?</p>
            <button class="choice-btn" onclick="checkChoice(1)">A) 500</button>
            <button class="choice-btn" onclick="checkChoice(2)">B) 800</button>
            <button class="choice-btn" onclick="checkChoice(3)">C) 750</button>
            <button class="choice-btn" onclick="checkChoice(4)">D) 1000</button>
        `;
    } else if (currentQ === 2) {
        gameDiv.innerHTML = `
            <p>City Projects Fund: How much went to community outreach?</p>
            <button class="choice-btn" onclick="checkChoice(1)">A) 1000</button>
            <button class="choice-btn" onclick="checkChoice(2)">B) 1500</button>
            <button class="choice-btn" onclick="checkChoice(3)">C) 1200</button>
            <button class="choice-btn" onclick="checkChoice(4)">D) 2000</button>
        `;
    } else if (currentQ > 2) {
        endGame();
    }
}

function endGame() {
    const gameDiv = document.getElementById('budget-game');
    gameDiv.innerHTML = '<p>All budget allocations completed.</p>';
    nextBtn.style.display = "block";
    console.log("done");

    const outcome = document.getElementById('outcome');
    outcome.innerHTML = `
        I performed maintenance checks personally and managed the budget responsibly.<br>
        Publicly, I blamed the engineer and supervisor to maintain trust in the city.<br>
        The public praises my actions, and the engineer and supervisor are arrested.<br>
        The city sees a responsible mayor at work, while I.. am protected.
    `;

    
}

function proceedChapter(){
    window.location.href = "act4game.html";
}
</script>

</body>
</html>
